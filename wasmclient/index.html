<!doctype html>
<html>
    <script src='wasm-client.js'></script>    
    <script> 

        BeamModule().then(function(Module) 
        {
            var phrase = Module.WasmWalletClient.GeneratePhrase()
            console.log('seed phrase is: ', phrase);
            console.log("IsAllowedWord('hurdle') -", Module.WasmWalletClient.IsAllowedWord('hurdle'))
            console.log("IsValidPhrase()", Module.WasmWalletClient.IsValidPhrase(phrase))
            console.log('world list size is', phrase.split(' ').length)
            Module.WasmWalletClient.MountFS(function()
                {
                    console.log("mounted");
                    //Module.WasmWalletClient.CreateWallet(phrase, "/beam_wallet/wallet.db", "123");
                    var walletClient = new Module.WasmWalletClient("/beam_wallet/wallet.db", "123", "127.0.0.1:8101")//"eu-node03.masternet.beam.mw:8100");
                    {
                        console.log("starting wallet...");
                        walletClient.startWallet();
                        var i = walletClient.subscribe((r)=> {
                            console.log("response: " + r)
                        });
                        walletClient.sendRequest(JSON.stringify({
                              jsonrpc: '2.0',
                              id: 5,
                              method: 'wallet_status'
                            }));

                        //walletClient.unsubscribe(i)    
                        walletClient.sendRequest(JSON.stringify({
                              jsonrpc: '2.0',
                              id: 5,
                              method: 'tx_list'
                            }));
                        walletClient.sendRequest(JSON.stringify({
                              jsonrpc: '2.0',
                              id: 2,
                              method: 'tx_send',
                              params: {
                                value: 1234,
                                address: "AfsQCJmL1h8zRiKibvswvvXVMkKnMRbG8PFK1kHfNVDkWWT78TSUNzDrc1Lz6Jb1VBvLshjt3drt91vT9WRYiSp2zFRLEHm4hhnPjf564qUADQB8i34eykFPuBYME3cU4q5315YLwMQCK6ZpERYQ9K7RPnJ2rcF5Yd1N9aRRefnBhkm1qqavgQqML5"
                              }
                            }) + '\n');
                    }
                });
           
        })
    </script>
</html>
